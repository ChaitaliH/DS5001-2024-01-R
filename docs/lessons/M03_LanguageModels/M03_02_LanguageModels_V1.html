<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploratory Text Analytics - 10&nbsp; Inferring Language Models v1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V2.html" rel="next">
<link href="../../lessons/M03_LanguageModels/M03_01a_EntropyExamples.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-title">Inferring Language Models v1</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Exploratory Text Analytics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ontoligent/DS5001-2024-01-R" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">M01 Introduction</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_01_getting-started.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Setting Up Your Jupyter Environmnet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_02_hello.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lab: Hello, World!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_03_first-foray.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lab: First Foray</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M01_Intro/M01_04_FurtherExploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Lab: Further Exploration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">M02 TextModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M02_TextModels/M02_01_Importing-Persuasion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Text into Data: Importing a Text, or, Clip, Chunk, and Split</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M02_TextModels/M02_02_TokenizingWithSciKitLearn.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Tokenizing with SciKit Learn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M02_TextModels/M02_03_Challenge.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Challenge: Convert Another Text</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">M03 LanguageModels</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_01_Babel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Baby Babel</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_01a_EntropyExamples.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Entropy Examples</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V1.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Inferring Language Models v1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Inferring Language Models (v2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V3.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Inferring Language Models (v3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_02_SimpleLangModel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Demonstration of Simple Language Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_03_Entropy-and-Perplexity.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Entropy and Peplexity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_04-Entropy-and-Term-Length.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Entropy and Term Length</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M03_LanguageModels/M03_EZ.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">How to Create an N-Gram Model from ScratchHow to Create an N-Gram Model from Scratch</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">M04 NLP</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M04_NLP/M04_00_NLTK_Intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">NLTK Parsers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M04_NLP/M04_01_Pipeline.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">NLP and the Pipeline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M04_NLP/M04_02_HMM.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Predict POS with an HMM</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">M05 VectorSpaceModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M05_VectorSpaceModels/M05_01_BOW_TFIDF.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Vector Spaces, BOW, and TFIDF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M05_VectorSpaceModels/M05_02_TimeTokenMatrices.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Time-Token Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M05_VectorSpaceModels/M05_03_TFIDF_Exploration.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Variant TFIDFs and Document Significance</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">M06 CusteringSimilarity</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M06_CusteringSimilarity/M06_01_SimilarityMeasures.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Similarity and Distance Measures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">M07 FeaturesAndComponents</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M07_FeaturesAndComponents/M07_01_PCA.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">PCA from Scratch</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">M08 TopicModels</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_01_GibbsSampler.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Gibbs Sampler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_02_LDASciKitLearn.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">LDA with SciKit Learn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_03_TopicSimilarity.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Topic Similarity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_04_TopicContiguity.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Topic Contiguity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/M08_05_PyLDAVis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">PyLDAVis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08_TopicModels/Untitled.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Untitled.html</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">M08a Visualization</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_01_Gensim.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Other Tools</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_02_GensimRunCompareLDA.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_03_MALLET.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M08a_Visualization/M08a_04_Mazo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">M09 WordEmbedding</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_01_GloVe.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_02_PMI_SVD.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_03_SkipgramRepresentation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_04_word2vec.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/M09_05_FastText.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/Untitled.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Untitled.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M09_WordEmbedding/run_fasttext.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">FastText Model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">M10 SentimentAnalysis</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_01_GeneralInquirer.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_02_CombineLexicons.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_03_Novel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_04_AustenMelville.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_05_WordShiftGraphs.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M10_SentimentAnalysis/M10_06_Doc2Vec.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">M11 Narrative</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_01_ExportBooksWithSentiment.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_02_SyuzhetPlots.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_03_Syuzhet_R.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M11_Narrative/M11_04_Syuzhet_RGeneral.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">M12 Classification</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_01_NaiveBayesWineReviews.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_01b_SKLearnMNB.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_02_PerceptronWine.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_03.ExpectedMutualInformation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/M12_04_Viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M12_Classification/Untitled.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">M13 LLMs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_01_ChatGPTDemo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_02_ChatGPTDemo2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_03_ChatGPT4Demo.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/M13_play.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">M13_play.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M13_LLMs/tokenizer_training.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Loading the dataset</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">M90 DispersionPlots</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M90_DispersionPlots/m01.04-austen-kde.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Synopsis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M90_DispersionPlots/onehot.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">onehot.html</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">M91 Charrette</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M91_Charrette/CharretteFIguresAndCharacters.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Figures and Characters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M91_Charrette/CharretteTokens.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Config</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false">M92 Helpers</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M92_Helpers/M00_01_VectorizationWithSKLearn.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../lessons/M92_Helpers/M00_02_SpaCy.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Metadata</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#set-up" id="toc-set-up" class="nav-link active" data-scroll-target="#set-up">Set Up</a>
  <ul class="collapse">
  <li><a href="#import-libraries" id="toc-import-libraries" class="nav-link" data-scroll-target="#import-libraries">Import libraries</a></li>
  <li><a href="#configure" id="toc-configure" class="nav-link" data-scroll-target="#configure">Configure</a></li>
  </ul></li>
  <li><a href="#import-and-combine-texts" id="toc-import-and-combine-texts" class="nav-link" data-scroll-target="#import-and-combine-texts">Import and combine texts</a></li>
  <li><a href="#extract-a-vocabulary" id="toc-extract-a-vocabulary" class="nav-link" data-scroll-target="#extract-a-vocabulary">Extract a vocabulary</a>
  <ul class="collapse">
  <li><a href="#nornalize-tokens" id="toc-nornalize-tokens" class="nav-link" data-scroll-target="#nornalize-tokens">Nornalize tokens</a></li>
  <li><a href="#count-tokens" id="toc-count-tokens" class="nav-link" data-scroll-target="#count-tokens">Count tokens</a></li>
  <li><a href="#quick-look-at-most-frequent-terms" id="toc-quick-look-at-most-frequent-terms" class="nav-link" data-scroll-target="#quick-look-at-most-frequent-terms">Quick look at most frequent terms</a></li>
  </ul></li>
  <li><a href="#simple-unigram-model" id="toc-simple-unigram-model" class="nav-link" data-scroll-target="#simple-unigram-model">Simple Unigram Model</a>
  <ul class="collapse">
  <li><a href="#extract-probability-features-p-i-and-h" id="toc-extract-probability-features-p-i-and-h" class="nav-link" data-scroll-target="#extract-probability-features-p-i-and-h">Extract probability features (<span class="math inline">\(p\)</span>, <span class="math inline">\(i\)</span>, and <span class="math inline">\(h\)</span>)</a></li>
  <li><a href="#compute-entropy-of-the-model" id="toc-compute-entropy-of-the-model" class="nav-link" data-scroll-target="#compute-entropy-of-the-model">Compute Entropy of the model</a></li>
  <li><a href="#compute-redundancy" id="toc-compute-redundancy" class="nav-link" data-scroll-target="#compute-redundancy">Compute Redundancy</a></li>
  <li><a href="#predict-senteces" id="toc-predict-senteces" class="nav-link" data-scroll-target="#predict-senteces">Predict Senteces</a></li>
  </ul></li>
  <li><a href="#n-gram-models" id="toc-n-gram-models" class="nav-link" data-scroll-target="#n-gram-models">N-Gram models</a>
  <ul class="collapse">
  <li><a href="#generate-three-models" id="toc-generate-three-models" class="nav-link" data-scroll-target="#generate-three-models">Generate three models</a></li>
  <li><a href="#compute-joint-probabilities" id="toc-compute-joint-probabilities" class="nav-link" data-scroll-target="#compute-joint-probabilities">Compute joint probabilities</a></li>
  <li><a href="#compute-conditional-probabilities" id="toc-compute-conditional-probabilities" class="nav-link" data-scroll-target="#compute-conditional-probabilities">Compute conditional probabilities</a></li>
  </ul></li>
  <li><a href="#predict-sentences" id="toc-predict-sentences" class="nav-link" data-scroll-target="#predict-sentences">Predict Sentences</a></li>
  <li><a href="#explore-pairs" id="toc-explore-pairs" class="nav-link" data-scroll-target="#explore-pairs">Explore Pairs</a></li>
  <li><a href="#generate-text" id="toc-generate-text" class="nav-link" data-scroll-target="#generate-text">Generate Text</a></li>
  <li><a href="#save" id="toc-save" class="nav-link" data-scroll-target="#save">Save</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/ontoligent/DS5001-2024-01-R/blob/main/lessons/M03_LanguageModels/M03_02_LanguageModels_V1.ipynb" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-title">Inferring Language Models v1</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="sourceCode" id="cb1"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Course</span><span class="kw">:</span><span class="at">  DS 5001</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Module</span><span class="kw">:</span><span class="at">  03 Lab</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Topic</span><span class="kw">:</span><span class="at">   Inferring Language Models</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Version</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Author</span><span class="kw">:</span><span class="at">  R.C. Alvarado</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Date</span><span class="kw">:</span><span class="at">    22 January 2022 (modified)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Purpose</strong>:</p>
<p>We now create a series of simple n-gram langage models from a set of novels and evaluate them.</p>
<p>We don’t worry about missing words, smoothing, etc. This is just to demonstrate how we convert the counts from a token table into a language model.</p>
<section id="set-up" class="level2">
<h2 class="anchored" data-anchor-id="set-up">Set Up</h2>
<section id="import-libraries" class="level3">
<h3 class="anchored" data-anchor-id="import-libraries">Import libraries</h3>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns<span class="op">;</span> sns.<span class="bu">set</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="configure" class="level3">
<h3 class="anchored" data-anchor-id="configure">Configure</h3>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> configparser</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> configparser.ConfigParser()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>config.read(<span class="st">"../env.ini"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> config[<span class="st">'DEFAULT'</span>][<span class="st">'data_home'</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>output_dir <span class="op">=</span> config[<span class="st">'DEFAULT'</span>][<span class="st">'output_dir'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="import-and-combine-texts" class="level2">
<h2 class="anchored" data-anchor-id="import-and-combine-texts">Import and combine texts</h2>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>OHCO <span class="op">=</span> [<span class="st">'book_id'</span>, <span class="st">'chap_num'</span>, <span class="st">'para_num'</span>, <span class="st">'sent_num'</span>, <span class="st">'token_num'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>text_file1 <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">/austen-persuasion.csv'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>text_file2 <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">/austen-sense.csv'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>text1 <span class="op">=</span> pd.read_csv(text_file1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>text2 <span class="op">=</span> pd.read_csv(text_file2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>text1.head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>chap_num</th>
      <th>para_num</th>
      <th>sent_num</th>
      <th>token_num</th>
      <th>token_str</th>
      <th>term_str</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Sir</td>
      <td>sir</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>Walter</td>
      <td>walter</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>Elliot</td>
      <td>elliot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>of</td>
      <td>of</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>Kellynch</td>
      <td>kellynch</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>Hall</td>
      <td>hall</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>in</td>
      <td>in</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>Somersetshire</td>
      <td>somersetshire</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>was</td>
      <td>was</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>a</td>
      <td>a</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>text1[<span class="st">'book_id'</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>text2[<span class="st">'book_id'</span>] <span class="op">=</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>text1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>chap_num</th>
      <th>para_num</th>
      <th>sent_num</th>
      <th>token_num</th>
      <th>token_str</th>
      <th>term_str</th>
      <th>book_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>Sir</td>
      <td>sir</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>Walter</td>
      <td>walter</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>Elliot</td>
      <td>elliot</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>of</td>
      <td>of</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>Kellynch</td>
      <td>kellynch</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tokens <span class="op">=</span> pd.concat([text1, text2]).dropna().set_index(OHCO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tokens.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>token_str</th>
      <th>term_str</th>
    </tr>
    <tr>
      <th>book_id</th>
      <th>chap_num</th>
      <th>para_num</th>
      <th>sent_num</th>
      <th>token_num</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">0</th>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>Sir</td>
      <td>sir</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walter</td>
      <td>walter</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Elliot</td>
      <td>elliot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>of</td>
      <td>of</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kellynch</td>
      <td>kellynch</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="extract-a-vocabulary" class="level2">
<h2 class="anchored" data-anchor-id="extract-a-vocabulary">Extract a vocabulary</h2>
<section id="nornalize-tokens" class="level3">
<h3 class="anchored" data-anchor-id="nornalize-tokens">Nornalize tokens</h3>
<p>We use a simple normalization scheme – remove all non-alphanumeric characters, including underscores.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tokens[<span class="st">'term_str'</span>] <span class="op">=</span> tokens[<span class="st">'token_str'</span>].<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="vs">r'[\W_]'</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tokens</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>token_str</th>
      <th>term_str</th>
    </tr>
    <tr>
      <th>book_id</th>
      <th>chap_num</th>
      <th>para_num</th>
      <th>sent_num</th>
      <th>token_num</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">1</th>
      <th rowspan="5" valign="top">0</th>
      <th rowspan="5" valign="top">0</th>
      <th>0</th>
      <td>Sir</td>
      <td>sir</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walter</td>
      <td>walter</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Elliot</td>
      <td>elliot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>of</td>
      <td>of</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kellynch</td>
      <td>kellynch</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2</th>
      <th rowspan="5" valign="top">50</th>
      <th rowspan="5" valign="top">23</th>
      <th rowspan="5" valign="top">0</th>
      <th>8</th>
      <td>and</td>
      <td>and</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Sensibility</td>
      <td>sensibility</td>
    </tr>
    <tr>
      <th>10</th>
      <td>by</td>
      <td>by</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Jane</td>
      <td>jane</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Austen</td>
      <td>austen</td>
    </tr>
  </tbody>
</table>
<p>204801 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="count-tokens" class="level3">
<h3 class="anchored" data-anchor-id="count-tokens">Count tokens</h3>
<p>We create a dataframe of unique tokens, i.e.&nbsp;token <em>types</em>, which we will call “terms”. Our first feature will be their counts.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>vocab <span class="op">=</span> tokens[<span class="st">'term_str'</span>].value_counts()<span class="op">\</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    .to_frame(<span class="st">'n'</span>)<span class="op">\</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    .sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>vocab.sample(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
    </tr>
    <tr>
      <th>term_str</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>vine</th>
      <td>1</td>
    </tr>
    <tr>
      <th>discriminating</th>
      <td>1</td>
    </tr>
    <tr>
      <th>hinder</th>
      <td>1</td>
    </tr>
    <tr>
      <th>therefore</th>
      <td>121</td>
    </tr>
    <tr>
      <th>circuit</th>
      <td>1</td>
    </tr>
    <tr>
      <th>worldly</th>
      <td>7</td>
    </tr>
    <tr>
      <th>noticing</th>
      <td>2</td>
    </tr>
    <tr>
      <th>accommodations</th>
      <td>7</td>
    </tr>
    <tr>
      <th>foibles</th>
      <td>1</td>
    </tr>
    <tr>
      <th>privileged</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="quick-look-at-most-frequent-terms" class="level3">
<h3 class="anchored" data-anchor-id="quick-look-at-most-frequent-terms">Quick look at most frequent terms</h3>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>vocab.n.nlargest(<span class="dv">20</span>).sort_values().plot.barh(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>), fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="M03_02_LanguageModels_V1_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="simple-unigram-model" class="level2">
<h2 class="anchored" data-anchor-id="simple-unigram-model">Simple Unigram Model</h2>
<section id="extract-probability-features-p-i-and-h" class="level3">
<h3 class="anchored" data-anchor-id="extract-probability-features-p-i-and-h">Extract probability features (<span class="math inline">\(p\)</span>, <span class="math inline">\(i\)</span>, and <span class="math inline">\(h\)</span>)</h3>
<p>We use <span class="math inline">\(i\)</span> to stand for the inverse log probability of <span class="math inline">\(x\)</span>, following our intuition that it represents information as “surprisal”.</p>
<p>$ i(x) = log_2() $</p>
<p><span class="math inline">\(i\)</span> is the inverse of log probability, second term in the entropy formula $ H(x) = _x p(x) log_2() $</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n_tokens <span class="op">=</span> vocab.n.<span class="bu">sum</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n_terms <span class="op">=</span> vocab.n.count() <span class="co"># same as vocab.shape[0]</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>vocab[<span class="st">'p'</span>] <span class="op">=</span> vocab[<span class="st">'n'</span>] <span class="op">/</span> n_tokens</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>vocab[<span class="st">'p2'</span>] <span class="op">=</span> vocab[<span class="st">'n'</span>] <span class="op">/</span> n_terms <span class="co"># Some sources say to do this, but it makes no sense</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>vocab[<span class="st">'i'</span>] <span class="op">=</span> np.log2(<span class="dv">1</span><span class="op">/</span>vocab[<span class="st">'p'</span>])</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>vocab[<span class="st">'h'</span>] <span class="op">=</span> vocab[<span class="st">'p'</span>] <span class="op">*</span> vocab[<span class="st">'i'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>vocab.sort_values(<span class="st">'p'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
      <th>p</th>
      <th>p2</th>
      <th>i</th>
      <th>h</th>
    </tr>
    <tr>
      <th>term_str</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>the</th>
      <td>7435</td>
      <td>0.036304</td>
      <td>0.902525</td>
      <td>4.783746</td>
      <td>0.173667</td>
    </tr>
    <tr>
      <th>to</th>
      <td>6923</td>
      <td>0.033804</td>
      <td>0.840374</td>
      <td>4.886682</td>
      <td>0.165187</td>
    </tr>
    <tr>
      <th>and</th>
      <td>6290</td>
      <td>0.030713</td>
      <td>0.763535</td>
      <td>5.025019</td>
      <td>0.154332</td>
    </tr>
    <tr>
      <th>of</th>
      <td>6146</td>
      <td>0.030010</td>
      <td>0.746055</td>
      <td>5.058431</td>
      <td>0.151802</td>
    </tr>
    <tr>
      <th>her</th>
      <td>3747</td>
      <td>0.018296</td>
      <td>0.454843</td>
      <td>5.772343</td>
      <td>0.105610</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>reservedness</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>reserving</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>enthusiast</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>nipped</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>divisions</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
  </tbody>
</table>
<p>8238 rows × 5 columns</p>
</div>
</div>
</div>
</section>
<section id="compute-entropy-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="compute-entropy-of-the-model">Compute Entropy of the model</h3>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> vocab.h.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>9.149850013062554</code></pre>
</div>
</div>
</section>
<section id="compute-redundancy" class="level3">
<h3 class="anchored" data-anchor-id="compute-redundancy">Compute Redundancy</h3>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Hmax <span class="op">=</span> np.log2(n_terms)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> (H<span class="op">/</span>Hmax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(<span class="bu">round</span>(R, <span class="dv">2</span>) <span class="op">*</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>30</code></pre>
</div>
</div>
<p>So, the redundancy of Austen’s English from these two novels <span class="math inline">\(R_{austen}\)</span> is about <span class="math inline">\(30\%\)</span>. Shannon estimated the redundancy of English <span class="math inline">\(R_{english}\)</span> to be <span class="math inline">\(54\%\)</span> (see Shannon 1953 in the Readings).</p>
</section>
<section id="predict-senteces" class="level3">
<h3 class="anchored" data-anchor-id="predict-senteces">Predict Senteces</h3>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>vocab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
      <th>p</th>
      <th>p2</th>
      <th>i</th>
      <th>h</th>
    </tr>
    <tr>
      <th>term_str</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0.000015</td>
      <td>0.000364</td>
      <td>16.058901</td>
      <td>0.000235</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>1760</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>1784</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>youthful</th>
      <td>3</td>
      <td>0.000015</td>
      <td>0.000364</td>
      <td>16.058901</td>
      <td>0.000235</td>
    </tr>
    <tr>
      <th>z</th>
      <td>1</td>
      <td>0.000005</td>
      <td>0.000121</td>
      <td>17.643863</td>
      <td>0.000086</td>
    </tr>
    <tr>
      <th>zeal</th>
      <td>7</td>
      <td>0.000034</td>
      <td>0.000850</td>
      <td>14.836508</td>
      <td>0.000507</td>
    </tr>
    <tr>
      <th>zealous</th>
      <td>4</td>
      <td>0.000020</td>
      <td>0.000486</td>
      <td>15.643863</td>
      <td>0.000306</td>
    </tr>
    <tr>
      <th>zealously</th>
      <td>2</td>
      <td>0.000010</td>
      <td>0.000243</td>
      <td>16.643863</td>
      <td>0.000163</td>
    </tr>
  </tbody>
</table>
<p>8238 rows × 5 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_sentence(sent_str, smooth <span class="op">=</span> <span class="fl">.5</span>):</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parse sentence into tokens and normalize string</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> sent_str.lower().split()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> [re.sub(<span class="vs">r'[\W_]+'</span>, <span class="st">''</span>, s) <span class="cf">for</span> s <span class="kw">in</span> S]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(S)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle out of vocabulary words</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    OOV <span class="op">=</span> [(w, smooth) <span class="cf">for</span> w <span class="kw">in</span> <span class="bu">list</span>(<span class="bu">set</span>(S) <span class="op">-</span> <span class="bu">set</span>(vocab.index))]</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(OOV) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        new_row <span class="op">=</span> pd.DataFrame(OOV, columns<span class="op">=</span>[<span class="st">'term_str'</span>,<span class="st">'n'</span>]).set_index(<span class="st">'term_str'</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        V <span class="op">=</span> pd.concat([vocab[[<span class="st">'n'</span>]], new_row], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># V = vocab[['n']].append(pd.DataFrame(OOV, columns=['term_str','n']).set_index('term_str')).copy()</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        V[<span class="st">'p'</span>] <span class="op">=</span> V.n <span class="op">/</span> V.n.<span class="bu">sum</span>()</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        V <span class="op">=</span> vocab[[<span class="st">'n'</span>,<span class="st">'p'</span>]].copy()        </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    V[<span class="st">'i'</span>] <span class="op">=</span> np.log2(<span class="dv">1</span><span class="op">/</span>V.p)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create dataframe of tokens from sentence</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> pd.DataFrame(S, columns<span class="op">=</span>[<span class="st">'term_str'</span>]).set_index(<span class="st">'term_str'</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Link the tokens with model vocabulary</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> tokens.merge(V, on<span class="op">=</span><span class="st">'term_str'</span>)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute Perplexity</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    pp <span class="op">=</span> <span class="dv">2</span><span class="op">**</span>(tokens.i.<span class="bu">sum</span>()<span class="op">/</span>N)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (sent_str, pp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>test_sentences <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="st">I love you</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="st">I love cars</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="st">I want to</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="st">Anne said to</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="st">said to her</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="st">said to him</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="st">she read the</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>pdata <span class="op">=</span> []</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> S <span class="kw">in</span> test_sentences:</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    pdata.append(predict_sentence(S))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(pdata, columns<span class="op">=</span>[<span class="st">'sent_str'</span>, <span class="st">'pp'</span>]).sort_values(<span class="st">'pp'</span>).style.background_gradient()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<style type="text/css">
#T_cc757_row0_col1 {
  background-color: #fff7fb;
  color: #000000;
}
#T_cc757_row1_col1 {
  background-color: #fdf5fa;
  color: #000000;
}
#T_cc757_row2_col1 {
  background-color: #fcf4fa;
  color: #000000;
}
#T_cc757_row3_col1 {
  background-color: #fbf4f9;
  color: #000000;
}
#T_cc757_row4_col1, #T_cc757_row5_col1 {
  background-color: #f9f2f8;
  color: #000000;
}
#T_cc757_row6_col1 {
  background-color: #023858;
  color: #f1f1f1;
}
</style>
<table id="T_cc757">
  <thead>
    <tr>
      <th class="blank level0">&nbsp;</th>
      <th id="T_cc757_level0_col0" class="col_heading level0 col0">sent_str</th>
      <th id="T_cc757_level0_col1" class="col_heading level0 col1">pp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_cc757_level0_row0" class="row_heading level0 row0">4</th>
      <td id="T_cc757_row0_col0" class="data row0 col0">said to her</td>
      <td id="T_cc757_row0_col1" class="data row0 col1">83.441310</td>
    </tr>
    <tr>
      <th id="T_cc757_level0_row1" class="row_heading level0 row1">5</th>
      <td id="T_cc757_row1_col0" class="data row1 col0">said to him</td>
      <td id="T_cc757_row1_col1" class="data row1 col1">125.207928</td>
    </tr>
    <tr>
      <th id="T_cc757_level0_row2" class="row_heading level0 row2">3</th>
      <td id="T_cc757_row2_col0" class="data row2 col0">Anne said to</td>
      <td id="T_cc757_row2_col1" class="data row2 col1">162.962001</td>
    </tr>
    <tr>
      <th id="T_cc757_level0_row3" class="row_heading level0 row3">2</th>
      <td id="T_cc757_row3_col0" class="data row3 col0">I want to</td>
      <td id="T_cc757_row3_col1" class="data row3 col1">175.011992</td>
    </tr>
    <tr>
      <th id="T_cc757_level0_row4" class="row_heading level0 row4">6</th>
      <td id="T_cc757_row4_col0" class="data row4 col0">she read the</td>
      <td id="T_cc757_row4_col1" class="data row4 col1">228.717029</td>
    </tr>
    <tr>
      <th id="T_cc757_level0_row5" class="row_heading level0 row5">0</th>
      <td id="T_cc757_row5_col0" class="data row5 col0">I love you</td>
      <td id="T_cc757_row5_col1" class="data row5 col1">233.229387</td>
    </tr>
    <tr>
      <th id="T_cc757_level0_row6" class="row_heading level0 row6">1</th>
      <td id="T_cc757_row6_col0" class="data row6 col0">I love cars</td>
      <td id="T_cc757_row6_col1" class="data row6 col1">3587.059356</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
</section>
<section id="n-gram-models" class="level2">
<h2 class="anchored" data-anchor-id="n-gram-models">N-Gram models</h2>
<p>This function generates models up to the length specified.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_ngrams(n<span class="op">=</span><span class="dv">2</span>):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate n-gram models for each value of n"""</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> tokens, OHCO</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create list to store copies of tokens table</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> []</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert the index to cols in order to change the value of token_num</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    X.append(tokens[<span class="st">'term_str'</span>].reset_index())</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create copies of token table for each level of ngram, offset by 1, and </span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># merge with previous </span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Append a new copy of the token list</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        X.append(X[<span class="dv">0</span>].copy()) </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Offset the token num by 1 each time</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>        X[i][<span class="st">'token_num'</span>] <span class="op">=</span> X[i][<span class="st">'token_num'</span>] <span class="op">+</span> i </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Merge the new dataframe with the previous, using the OHCO as key, </span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># to preserve structure, including sentence boundaries</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        X[i] <span class="op">=</span> X[i].merge(X[i<span class="op">-</span><span class="dv">1</span>], on<span class="op">=</span>OHCO, how<span class="op">=</span><span class="st">'left'</span>, </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>                          sort<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>                          suffixes<span class="op">=</span>[<span class="ss">f"</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]).fillna(<span class="st">'&lt;s&gt;'</span>)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(i)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(X[i].head())</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'-'</span> <span class="op">*</span> <span class="dv">40</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compress tables to unique ngrams with counts; </span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, n):</span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>        X[i] <span class="op">=</span> X[i].drop(OHCO, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>        cols <span class="op">=</span> X[i].columns.tolist()</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>        X[i] <span class="op">=</span> X[i].value_counts().to_frame(<span class="st">'n'</span>)</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>        X[i].index.names <span class="op">=</span> [<span class="ss">f'w</span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i<span class="op">+</span><span class="dv">1</span>)]</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>        X[i] <span class="op">=</span> X[i].sort_index()</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return just the ngram tables</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generate-three-models" class="level3">
<h3 class="anchored" data-anchor-id="generate-three-models">Generate three models</h3>
<p>Unigram, bigram, and trigram</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>m1, m2, m3 <span class="op">=</span> get_ngrams(n<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
   book_id  chap_num  para_num  sent_num  token_num term_str1 term_str2
0        1         1         0         0          1       sir    walter
1        1         1         0         0          2    walter    elliot
2        1         1         0         0          3    elliot        of
3        1         1         0         0          4        of  kellynch
4        1         1         0         0          5  kellynch      hall
----------------------------------------
2
   book_id  chap_num  para_num  sent_num  token_num  term_str term_str1  \
0        1         1         0         0          2       sir    walter   
1        1         1         0         0          3    walter    elliot   
2        1         1         0         0          4    elliot        of   
3        1         1         0         0          5        of  kellynch   
4        1         1         0         0          6  kellynch      hall   

  term_str2  
0    elliot  
1        of  
2  kellynch  
3      hall  
4        in  
----------------------------------------</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>n</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th>w2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>1760</th>
      <th>married</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1785</th>
      <th>&lt;s&gt;</th>
      <td>1</td>
    </tr>
    <tr>
      <th>ends</th>
      <th>&lt;s&gt;</th>
      <td>1</td>
    </tr>
    <tr>
      <th>15</th>
      <th>1784</th>
      <th>elizabeth</th>
      <td>1</td>
    </tr>
    <tr>
      <th>16</th>
      <th>1810</th>
      <th>charles</th>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">zealous</th>
      <th>attention</th>
      <th>as</th>
      <td>1</td>
    </tr>
    <tr>
      <th>officer</th>
      <th>too</th>
      <td>1</td>
    </tr>
    <tr>
      <th>on</th>
      <th>the</th>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">zealously</th>
      <th>active</th>
      <th>as</th>
      <td>1</td>
    </tr>
    <tr>
      <th>discharging</th>
      <th>all</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>154242 rows × 1 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m2.sort_values(<span class="st">'n'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>n</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>of</th>
      <th>the</th>
      <td>857</td>
    </tr>
    <tr>
      <th>to</th>
      <th>be</th>
      <td>814</td>
    </tr>
    <tr>
      <th>in</th>
      <th>the</th>
      <td>682</td>
    </tr>
    <tr>
      <th>mrs</th>
      <th>&lt;s&gt;</th>
      <td>530</td>
    </tr>
    <tr>
      <th>it</th>
      <th>was</th>
      <td>498</td>
    </tr>
    <tr>
      <th>to</th>
      <th>the</th>
      <td>415</td>
    </tr>
    <tr>
      <th>she</th>
      <th>had</th>
      <td>411</td>
    </tr>
    <tr>
      <th>of</th>
      <th>her</th>
      <td>403</td>
    </tr>
    <tr>
      <th>had</th>
      <th>been</th>
      <td>379</td>
    </tr>
    <tr>
      <th>she</th>
      <th>was</th>
      <td>373</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>m3.loc[(<span class="st">'captain'</span>,<span class="st">'wentworth'</span>)].sort_values(<span class="st">'n'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
    </tr>
    <tr>
      <th>w2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>&lt;s&gt;</th>
      <td>26</td>
    </tr>
    <tr>
      <th>s</th>
      <td>26</td>
    </tr>
    <tr>
      <th>was</th>
      <td>15</td>
    </tr>
    <tr>
      <th>in</th>
      <td>8</td>
    </tr>
    <tr>
      <th>had</th>
      <td>7</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>looked</th>
      <td>1</td>
    </tr>
    <tr>
      <th>long</th>
      <td>1</td>
    </tr>
    <tr>
      <th>left</th>
      <td>1</td>
    </tr>
    <tr>
      <th>jealous</th>
      <td>1</td>
    </tr>
    <tr>
      <th>now</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 1 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m3.loc[(<span class="st">'anne'</span>,<span class="st">'elliot'</span>)].sort_values(<span class="st">'n'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
    </tr>
    <tr>
      <th>w2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>&lt;s&gt;</th>
      <td>6</td>
    </tr>
    <tr>
      <th>and</th>
      <td>3</td>
    </tr>
    <tr>
      <th>as</th>
      <td>2</td>
    </tr>
    <tr>
      <th>with</th>
      <td>2</td>
    </tr>
    <tr>
      <th>again</th>
      <td>1</td>
    </tr>
    <tr>
      <th>deprived</th>
      <td>1</td>
    </tr>
    <tr>
      <th>had</th>
      <td>1</td>
    </tr>
    <tr>
      <th>have</th>
      <td>1</td>
    </tr>
    <tr>
      <th>should</th>
      <td>1</td>
    </tr>
    <tr>
      <th>so</th>
      <td>1</td>
    </tr>
    <tr>
      <th>to</th>
      <td>1</td>
    </tr>
    <tr>
      <th>was</th>
      <td>1</td>
    </tr>
    <tr>
      <th>were</th>
      <td>1</td>
    </tr>
    <tr>
      <th>you</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="compute-joint-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="compute-joint-probabilities">Compute joint probabilities</h3>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m1[<span class="st">'p'</span>] <span class="op">=</span> m1[<span class="st">'n'</span>] <span class="op">/</span> m1[<span class="st">'n'</span>].<span class="bu">sum</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m2[<span class="st">'p'</span>] <span class="op">=</span> m2[<span class="st">'n'</span>] <span class="op">/</span> m2[<span class="st">'n'</span>].<span class="bu">sum</span>()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>m3[<span class="st">'p'</span>] <span class="op">=</span> m3[<span class="st">'n'</span>] <span class="op">/</span> m3[<span class="st">'n'</span>].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="33">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m1.sort_values(<span class="st">'p'</span>, ascending<span class="op">=</span><span class="va">False</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>n</th>
      <th>p</th>
    </tr>
    <tr>
      <th>w0</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>the</th>
      <td>7435</td>
      <td>0.036304</td>
    </tr>
    <tr>
      <th>to</th>
      <td>6923</td>
      <td>0.033804</td>
    </tr>
    <tr>
      <th>and</th>
      <td>6290</td>
      <td>0.030713</td>
    </tr>
    <tr>
      <th>of</th>
      <td>6146</td>
      <td>0.030010</td>
    </tr>
    <tr>
      <th>her</th>
      <td>3747</td>
      <td>0.018296</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>m2.sort_values(<span class="st">'p'</span>, ascending<span class="op">=</span><span class="va">False</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>n</th>
      <th>p</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>of</th>
      <th>the</th>
      <td>857</td>
      <td>0.004185</td>
    </tr>
    <tr>
      <th>to</th>
      <th>be</th>
      <td>814</td>
      <td>0.003975</td>
    </tr>
    <tr>
      <th>in</th>
      <th>the</th>
      <td>682</td>
      <td>0.003330</td>
    </tr>
    <tr>
      <th>mrs</th>
      <th>&lt;s&gt;</th>
      <td>530</td>
      <td>0.002588</td>
    </tr>
    <tr>
      <th>it</th>
      <th>was</th>
      <td>498</td>
      <td>0.002432</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>m3.sort_values(<span class="st">'p'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>n</th>
      <th>p</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th>w2</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mrs</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>530</td>
      <td>0.002588</td>
    </tr>
    <tr>
      <th>it</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>369</td>
      <td>0.001802</td>
    </tr>
    <tr>
      <th>her</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>241</td>
      <td>0.001177</td>
    </tr>
    <tr>
      <th>him</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>229</td>
      <td>0.001118</td>
    </tr>
    <tr>
      <th>mr</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>179</td>
      <td>0.000874</td>
    </tr>
    <tr>
      <th>you</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>172</td>
      <td>0.000840</td>
    </tr>
    <tr>
      <th>them</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>163</td>
      <td>0.000796</td>
    </tr>
    <tr>
      <th>me</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>162</td>
      <td>0.000791</td>
    </tr>
    <tr>
      <th>elinor</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>119</td>
      <td>0.000581</td>
    </tr>
    <tr>
      <th>i</th>
      <th>am</th>
      <th>sure</th>
      <td>107</td>
      <td>0.000522</td>
    </tr>
    <tr>
      <th>she</th>
      <th>could</th>
      <th>not</th>
      <td>93</td>
      <td>0.000454</td>
    </tr>
    <tr>
      <th>marianne</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>90</td>
      <td>0.000439</td>
    </tr>
    <tr>
      <th>again</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>85</td>
      <td>0.000415</td>
    </tr>
    <tr>
      <th>as</th>
      <th>soon</th>
      <th>as</th>
      <td>82</td>
      <td>0.000400</td>
    </tr>
    <tr>
      <th>all</th>
      <th>&lt;s&gt;</th>
      <th>&lt;s&gt;</th>
      <td>82</td>
      <td>0.000400</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="compute-conditional-probabilities" class="level3">
<h3 class="anchored" data-anchor-id="compute-conditional-probabilities">Compute conditional probabilities</h3>
<p><span class="math inline">\(p(w_1|w_0) = p(w_0, w_1) / p(w_0)\)</span></p>
<p><span class="math inline">\(p(w_2|w_0,w_1) = p(w_0, w_1, w_2) / p(w_0, w_1)\)</span></p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m2['cp'] = (m2.n / m1.n).sort_values().to_frame('p').sort_index()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>m2[<span class="st">'m1n'</span>] <span class="op">=</span> m1.n</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>m2[<span class="st">'cp'</span>] <span class="op">=</span> m2.n <span class="op">/</span> m2.m1n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>m2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>n</th>
      <th>p</th>
      <th>m1n</th>
      <th>cp</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>1760</th>
      <td>1</td>
      <td>0.000005</td>
      <td>3</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1785</th>
      <td>1</td>
      <td>0.000005</td>
      <td>3</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>ends</th>
      <td>1</td>
      <td>0.000005</td>
      <td>3</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>15</th>
      <th>1784</th>
      <td>1</td>
      <td>0.000005</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>16</th>
      <th>1810</th>
      <td>1</td>
      <td>0.000005</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">zealous</th>
      <th>attention</th>
      <td>1</td>
      <td>0.000005</td>
      <td>4</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>officer</th>
      <td>1</td>
      <td>0.000005</td>
      <td>4</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th>on</th>
      <td>1</td>
      <td>0.000005</td>
      <td>4</td>
      <td>0.250000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">zealously</th>
      <th>active</th>
      <td>1</td>
      <td>0.000005</td>
      <td>2</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>discharging</th>
      <td>1</td>
      <td>0.000005</td>
      <td>2</td>
      <td>0.500000</td>
    </tr>
  </tbody>
</table>
<p>77458 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># m3['cp'] = (m3.n / m2.n).sort_values().to_frame('p').sort_index()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m3[<span class="st">'m2n'</span>] <span class="op">=</span> m2.n</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>m3[<span class="st">'cp'</span>] <span class="op">=</span> m3.n <span class="op">/</span> m3.m2n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>m3.sort_values(<span class="st">'cp'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>n</th>
      <th>p</th>
      <th>m2n</th>
      <th>cp</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th>w2</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <th>1760</th>
      <th>married</th>
      <td>1</td>
      <td>0.000005</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>met</th>
      <th>mrs</th>
      <th>&lt;s&gt;</th>
      <td>2</td>
      <td>0.000010</td>
      <td>2</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">middletons</th>
      <th>dining</th>
      <th>at</th>
      <td>1</td>
      <td>0.000005</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>as</th>
      <th>much</th>
      <td>1</td>
      <td>0.000005</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>arrived</th>
      <th>so</th>
      <td>1</td>
      <td>0.000005</td>
      <td>1</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">of</th>
      <th rowspan="5" valign="top">the</th>
      <th>household</th>
      <td>1</td>
      <td>0.000005</td>
      <td>857</td>
      <td>0.001167</td>
    </tr>
    <tr>
      <th>hours</th>
      <td>1</td>
      <td>0.000005</td>
      <td>857</td>
      <td>0.001167</td>
    </tr>
    <tr>
      <th>higher</th>
      <td>1</td>
      <td>0.000005</td>
      <td>857</td>
      <td>0.001167</td>
    </tr>
    <tr>
      <th>heavy</th>
      <td>1</td>
      <td>0.000005</td>
      <td>857</td>
      <td>0.001167</td>
    </tr>
    <tr>
      <th>agitation</th>
      <td>1</td>
      <td>0.000005</td>
      <td>857</td>
      <td>0.001167</td>
    </tr>
  </tbody>
</table>
<p>154242 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>m2.cp.unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>w1</th>
      <th>1</th>
      <th>15</th>
      <th>16</th>
      <th>1760</th>
      <th>1784</th>
      <th>1785</th>
      <th>1787</th>
      <th>1789</th>
      <th>1791</th>
      <th>1800</th>
      <th>...</th>
      <th>your</th>
      <th>yours</th>
      <th>yourself</th>
      <th>yourselves</th>
      <th>youth</th>
      <th>youthful</th>
      <th>z</th>
      <th>zeal</th>
      <th>zealous</th>
      <th>zealously</th>
    </tr>
    <tr>
      <th>w0</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.0</td>
      <td>0.333333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1760</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1784</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>youthful</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>z</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>zeal</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>zealous</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>zealously</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>8238 rows × 8194 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m3.cp.unstack(fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>w2</th>
      <th>1</th>
      <th>15</th>
      <th>16</th>
      <th>1760</th>
      <th>1784</th>
      <th>1785</th>
      <th>1787</th>
      <th>1789</th>
      <th>1791</th>
      <th>1800</th>
      <th>...</th>
      <th>your</th>
      <th>yours</th>
      <th>yourself</th>
      <th>yourselves</th>
      <th>youth</th>
      <th>youthful</th>
      <th>z</th>
      <th>zeal</th>
      <th>zealous</th>
      <th>zealously</th>
    </tr>
    <tr>
      <th>w0</th>
      <th>w1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>1760</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1785</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>ends</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <th>1784</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <th>1810</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">zealous</th>
      <th>attention</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>officer</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>on</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">zealously</th>
      <th>active</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>discharging</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>77458 rows × 8079 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="predict-sentences" class="level2">
<h2 class="anchored" data-anchor-id="predict-sentences">Predict Sentences</h2>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_sentence2(sent_str, M):</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Model order</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(M.index.names)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parse sentence into tokens and normalize string</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> sent_str.lower().split()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> [re.sub(<span class="vs">r'[\W_]+'</span>, <span class="st">''</span>, s) <span class="cf">for</span> s <span class="kw">in</span> S]</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> S <span class="op">+</span> [<span class="st">'&lt;s&gt;'</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">-</span><span class="dv">1</span>)]</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="bu">len</span>(S)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate ngram keys </span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    ngrams <span class="op">=</span> []</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(offset, <span class="bu">len</span>(S)):</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>        ngram <span class="op">=</span> []</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        w <span class="op">=</span> S[i]</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>            ngram.append(S[i<span class="op">-</span>j])</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        ngram.reverse()</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        ngrams.append(ngram)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get smoothing -- </span><span class="al">HACK</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    smooth <span class="op">=</span> M.p.<span class="bu">min</span>()</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute the probability of the sentence</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    log_prob <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ngram <span class="kw">in</span> ngrams:</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>            p_ngram <span class="op">=</span> M.loc[<span class="bu">tuple</span>(ngram)].p</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">KeyError</span>:</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>            p_ngram <span class="op">=</span> smooth</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>        log_prob <span class="op">+=</span> np.log(p_ngram)</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> np.exp(log_prob)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>    pp <span class="op">=</span> <span class="bu">round</span>(p<span class="op">**</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>N)) </span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>([n, sent_str, p, pp])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>test_sentences <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="st">I love you</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="st">I love cars</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="st">I want to</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="st">Anne said to</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="st">said to her</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="st">said to him</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="st">she read the</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>pdata <span class="op">=</span> []</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> S <span class="kw">in</span> test_sentences:</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    pdata.append(predict_sentence2(S, m1))</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    pdata.append(predict_sentence2(S, m2))</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    pdata.append(predict_sentence2(S, m3))</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>R1 <span class="op">=</span> pd.DataFrame(pdata, columns<span class="op">=</span>[<span class="st">'model'</span>,<span class="st">'sent_str'</span>, <span class="st">'p'</span>, <span class="st">'pp'</span>]).set_index([<span class="st">'sent_str'</span>,<span class="st">'model'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>pd.concat([R1.p.unstack().rename(columns<span class="op">=</span>{col:<span class="ss">f"p</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> col <span class="kw">in</span> cols}), </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>           R1.pp.unstack().rename(columns<span class="op">=</span>{col:<span class="ss">f"pp</span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> col <span class="kw">in</span> cols} )], axis<span class="op">=</span><span class="dv">1</span>).style.background_gradient()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<style type="text/css">
#T_f32b6_row0_col0 {
  background-color: #eae6f1;
  color: #000000;
}
#T_f32b6_row0_col1, #T_f32b6_row0_col2, #T_f32b6_row1_col0, #T_f32b6_row1_col1, #T_f32b6_row1_col2, #T_f32b6_row2_col1, #T_f32b6_row3_col1, #T_f32b6_row3_col2, #T_f32b6_row4_col3, #T_f32b6_row4_col4, #T_f32b6_row5_col5, #T_f32b6_row6_col1, #T_f32b6_row6_col2 {
  background-color: #fff7fb;
  color: #000000;
}
#T_f32b6_row0_col3 {
  background-color: #fbf3f9;
  color: #000000;
}
#T_f32b6_row0_col4 {
  background-color: #bfc9e1;
  color: #000000;
}
#T_f32b6_row0_col5, #T_f32b6_row3_col5 {
  background-color: #89b1d4;
  color: #000000;
}
#T_f32b6_row1_col3, #T_f32b6_row1_col5, #T_f32b6_row4_col0, #T_f32b6_row4_col1, #T_f32b6_row5_col2, #T_f32b6_row6_col4, #T_f32b6_row6_col5 {
  background-color: #023858;
  color: #f1f1f1;
}
#T_f32b6_row1_col4 {
  background-color: #045788;
  color: #f1f1f1;
}
#T_f32b6_row2_col0, #T_f32b6_row6_col0 {
  background-color: #f8f1f8;
  color: #000000;
}
#T_f32b6_row2_col2, #T_f32b6_row4_col5, #T_f32b6_row5_col3, #T_f32b6_row5_col4 {
  background-color: #fdf5fa;
  color: #000000;
}
#T_f32b6_row2_col3, #T_f32b6_row6_col3 {
  background-color: #f7f0f7;
  color: #000000;
}
#T_f32b6_row2_col4 {
  background-color: #e7e3f0;
  color: #000000;
}
#T_f32b6_row2_col5, #T_f32b6_row3_col4 {
  background-color: #d2d2e7;
  color: #000000;
}
#T_f32b6_row3_col0 {
  background-color: #efe9f3;
  color: #000000;
}
#T_f32b6_row3_col3 {
  background-color: #faf3f9;
  color: #000000;
}
#T_f32b6_row4_col2 {
  background-color: #187cb6;
  color: #f1f1f1;
}
#T_f32b6_row5_col0 {
  background-color: #c1cae2;
  color: #000000;
}
#T_f32b6_row5_col1 {
  background-color: #bdc8e1;
  color: #000000;
}
</style>
<table id="T_f32b6">
  <thead>
    <tr>
      <th class="index_name level0">model</th>
      <th id="T_f32b6_level0_col0" class="col_heading level0 col0">p1</th>
      <th id="T_f32b6_level0_col1" class="col_heading level0 col1">p2</th>
      <th id="T_f32b6_level0_col2" class="col_heading level0 col2">p3</th>
      <th id="T_f32b6_level0_col3" class="col_heading level0 col3">pp1</th>
      <th id="T_f32b6_level0_col4" class="col_heading level0 col4">pp2</th>
      <th id="T_f32b6_level0_col5" class="col_heading level0 col5">pp3</th>
    </tr>
    <tr>
      <th class="index_name level0">sent_str</th>
      <th class="blank col0">&nbsp;</th>
      <th class="blank col1">&nbsp;</th>
      <th class="blank col2">&nbsp;</th>
      <th class="blank col3">&nbsp;</th>
      <th class="blank col4">&nbsp;</th>
      <th class="blank col5">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_f32b6_level0_row0" class="row_heading level0 row0">Anne said to</th>
      <td id="T_f32b6_row0_col0" class="data row0 col0">0.000000</td>
      <td id="T_f32b6_row0_col1" class="data row0 col1">0.000000</td>
      <td id="T_f32b6_row0_col2" class="data row0 col2">0.000000</td>
      <td id="T_f32b6_row0_col3" class="data row0 col3">163</td>
      <td id="T_f32b6_row0_col4" class="data row0 col4">2142</td>
      <td id="T_f32b6_row0_col5" class="data row0 col5">814</td>
    </tr>
    <tr>
      <th id="T_f32b6_level0_row1" class="row_heading level0 row1">I love cars</th>
      <td id="T_f32b6_row1_col0" class="data row1 col0">0.000000</td>
      <td id="T_f32b6_row1_col1" class="data row1 col1">0.000000</td>
      <td id="T_f32b6_row1_col2" class="data row1 col2">0.000000</td>
      <td id="T_f32b6_row1_col3" class="data row1 col3">2847</td>
      <td id="T_f32b6_row1_col4" class="data row1 col4">5724</td>
      <td id="T_f32b6_row1_col5" class="data row1 col5">1537</td>
    </tr>
    <tr>
      <th id="T_f32b6_level0_row2" class="row_heading level0 row2">I love you</th>
      <td id="T_f32b6_row2_col0" class="data row2 col0">0.000000</td>
      <td id="T_f32b6_row2_col1" class="data row2 col1">0.000000</td>
      <td id="T_f32b6_row2_col2" class="data row2 col2">0.000000</td>
      <td id="T_f32b6_row2_col3" class="data row2 col3">233</td>
      <td id="T_f32b6_row2_col4" class="data row2 col4">1201</td>
      <td id="T_f32b6_row2_col5" class="data row2 col5">549</td>
    </tr>
    <tr>
      <th id="T_f32b6_level0_row3" class="row_heading level0 row3">I want to</th>
      <td id="T_f32b6_row3_col0" class="data row3 col0">0.000000</td>
      <td id="T_f32b6_row3_col1" class="data row3 col1">0.000000</td>
      <td id="T_f32b6_row3_col2" class="data row3 col2">0.000000</td>
      <td id="T_f32b6_row3_col3" class="data row3 col3">175</td>
      <td id="T_f32b6_row3_col4" class="data row3 col4">1776</td>
      <td id="T_f32b6_row3_col5" class="data row3 col5">814</td>
    </tr>
    <tr>
      <th id="T_f32b6_level0_row4" class="row_heading level0 row4">said to her</th>
      <td id="T_f32b6_row4_col0" class="data row4 col0">0.000002</td>
      <td id="T_f32b6_row4_col1" class="data row4 col1">0.000000</td>
      <td id="T_f32b6_row4_col2" class="data row4 col2">0.000000</td>
      <td id="T_f32b6_row4_col3" class="data row4 col3">83</td>
      <td id="T_f32b6_row4_col4" class="data row4 col4">284</td>
      <td id="T_f32b6_row4_col5" class="data row4 col5">245</td>
    </tr>
    <tr>
      <th id="T_f32b6_level0_row5" class="row_heading level0 row5">said to him</th>
      <td id="T_f32b6_row5_col0" class="data row5 col0">0.000001</td>
      <td id="T_f32b6_row5_col1" class="data row5 col1">0.000000</td>
      <td id="T_f32b6_row5_col2" class="data row5 col2">0.000000</td>
      <td id="T_f32b6_row5_col3" class="data row5 col3">125</td>
      <td id="T_f32b6_row5_col4" class="data row5 col4">381</td>
      <td id="T_f32b6_row5_col5" class="data row5 col5">229</td>
    </tr>
    <tr>
      <th id="T_f32b6_level0_row6" class="row_heading level0 row6">she read the</th>
      <td id="T_f32b6_row6_col0" class="data row6 col0">0.000000</td>
      <td id="T_f32b6_row6_col1" class="data row6 col1">0.000000</td>
      <td id="T_f32b6_row6_col2" class="data row6 col2">0.000000</td>
      <td id="T_f32b6_row6_col3" class="data row6 col3">229</td>
      <td id="T_f32b6_row6_col4" class="data row6 col4">6438</td>
      <td id="T_f32b6_row6_col5" class="data row6 col5">1537</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
<section id="explore-pairs" class="level2">
<h2 class="anchored" data-anchor-id="explore-pairs">Explore Pairs</h2>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> explore_pairs(list1, list2):</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> m2</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    test_pairs <span class="op">=</span> []</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> <span class="bu">zip</span>(list1, list2):</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>            m2.loc[pair]</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>            test_pairs.append(pair)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">pass</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> m2.loc[test_pairs].cp.unstack(fill_value<span class="op">=</span><span class="dv">0</span>).style.background_gradient()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>explore_pairs([<span class="st">'he'</span>,<span class="st">'she'</span>,<span class="st">'it'</span>,<span class="st">'anne'</span>,<span class="st">'wentworth'</span>], [<span class="st">'is'</span>,<span class="st">'had'</span>,<span class="st">'was'</span>,<span class="st">'did'</span>,<span class="st">'felt'</span>,<span class="st">'thought'</span>,<span class="st">'looked'</span>,<span class="st">'said'</span>,<span class="st">'saw'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<style type="text/css">
#T_162d8_row0_col0, #T_162d8_row1_col1, #T_162d8_row2_col2, #T_162d8_row3_col3 {
  background-color: #023858;
  color: #f1f1f1;
}
#T_162d8_row0_col1, #T_162d8_row0_col2, #T_162d8_row0_col3, #T_162d8_row1_col0, #T_162d8_row1_col2, #T_162d8_row1_col3, #T_162d8_row2_col0, #T_162d8_row2_col1, #T_162d8_row2_col3, #T_162d8_row3_col0, #T_162d8_row3_col1, #T_162d8_row3_col2 {
  background-color: #fff7fb;
  color: #000000;
}
</style>
<table id="T_162d8">
  <thead>
    <tr>
      <th class="index_name level0">w1</th>
      <th id="T_162d8_level0_col0" class="col_heading level0 col0">is</th>
      <th id="T_162d8_level0_col1" class="col_heading level0 col1">had</th>
      <th id="T_162d8_level0_col2" class="col_heading level0 col2">was</th>
      <th id="T_162d8_level0_col3" class="col_heading level0 col3">did</th>
    </tr>
    <tr>
      <th class="index_name level0">w0</th>
      <th class="blank col0">&nbsp;</th>
      <th class="blank col1">&nbsp;</th>
      <th class="blank col2">&nbsp;</th>
      <th class="blank col3">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_162d8_level0_row0" class="row_heading level0 row0">he</th>
      <td id="T_162d8_row0_col0" class="data row0 col0">0.057803</td>
      <td id="T_162d8_row0_col1" class="data row0 col1">0.000000</td>
      <td id="T_162d8_row0_col2" class="data row0 col2">0.000000</td>
      <td id="T_162d8_row0_col3" class="data row0 col3">0.000000</td>
    </tr>
    <tr>
      <th id="T_162d8_level0_row1" class="row_heading level0 row1">she</th>
      <td id="T_162d8_row1_col0" class="data row1 col0">0.000000</td>
      <td id="T_162d8_row1_col1" class="data row1 col1">0.148967</td>
      <td id="T_162d8_row1_col2" class="data row1 col2">0.000000</td>
      <td id="T_162d8_row1_col3" class="data row1 col3">0.000000</td>
    </tr>
    <tr>
      <th id="T_162d8_level0_row2" class="row_heading level0 row2">it</th>
      <td id="T_162d8_row2_col0" class="data row2 col0">0.000000</td>
      <td id="T_162d8_row2_col1" class="data row2 col1">0.000000</td>
      <td id="T_162d8_row2_col2" class="data row2 col2">0.178175</td>
      <td id="T_162d8_row2_col3" class="data row2 col3">0.000000</td>
    </tr>
    <tr>
      <th id="T_162d8_level0_row3" class="row_heading level0 row3">anne</th>
      <td id="T_162d8_row3_col0" class="data row3 col0">0.000000</td>
      <td id="T_162d8_row3_col1" class="data row3 col1">0.000000</td>
      <td id="T_162d8_row3_col2" class="data row3 col2">0.000000</td>
      <td id="T_162d8_row3_col3" class="data row3 col3">0.015905</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>explore_pairs([<span class="st">'he'</span>, <span class="st">'she'</span>, <span class="st">'it'</span>], [<span class="st">'said'</span>,<span class="st">'felt'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<style type="text/css">
#T_bdc41_row0_col0, #T_bdc41_row1_col1 {
  background-color: #023858;
  color: #f1f1f1;
}
#T_bdc41_row0_col1, #T_bdc41_row1_col0 {
  background-color: #fff7fb;
  color: #000000;
}
</style>
<table id="T_bdc41">
  <thead>
    <tr>
      <th class="index_name level0">w1</th>
      <th id="T_bdc41_level0_col0" class="col_heading level0 col0">said</th>
      <th id="T_bdc41_level0_col1" class="col_heading level0 col1">felt</th>
    </tr>
    <tr>
      <th class="index_name level0">w0</th>
      <th class="blank col0">&nbsp;</th>
      <th class="blank col1">&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_bdc41_level0_row0" class="row_heading level0 row0">he</th>
      <td id="T_bdc41_row0_col0" class="data row0 col0">0.016378</td>
      <td id="T_bdc41_row0_col1" class="data row0 col1">0.000000</td>
    </tr>
    <tr>
      <th id="T_bdc41_level0_row1" class="row_heading level0 row1">she</th>
      <td id="T_bdc41_row1_col0" class="data row1 col0">0.000000</td>
      <td id="T_bdc41_row1_col1" class="data row1 col1">0.018123</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
<section id="generate-text" class="level2">
<h2 class="anchored" data-anchor-id="generate-text">Generate Text</h2>
<p>We use stupid back-off to account for missing ngrams.</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_text(start_word<span class="op">=</span><span class="st">'she'</span>, n<span class="op">=</span><span class="dv">250</span>):</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    words <span class="op">=</span> [start_word]</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(words) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>            w <span class="op">=</span> m2.loc[start_word].p</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>            next_word <span class="op">=</span> m2.loc[start_word].sample(weights<span class="op">=</span>w).index.values[<span class="dv">0</span>]</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> <span class="bu">len</span>(words) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>            bg <span class="op">=</span> <span class="bu">tuple</span>(words[<span class="op">-</span><span class="dv">2</span>:])</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                w <span class="op">=</span> m3.loc[bg].p</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                next_word <span class="op">=</span> m3.loc[bg].sample(weights<span class="op">=</span>w).index.values[<span class="dv">0</span>]</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">KeyError</span>:</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                ug <span class="op">=</span> bg[<span class="dv">1</span>]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> ug <span class="op">==</span> <span class="st">'&lt;s&gt;'</span>:</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                    next_word <span class="op">=</span> m1.sample(weights<span class="op">=</span>m1.p).index[<span class="dv">0</span>]</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                    w <span class="op">=</span> m2.loc[ug].p</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                    next_word <span class="op">=</span> m2.loc[ug].sample(weights<span class="op">=</span>w).index.values[<span class="dv">0</span>]</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Some words are returned as single item tuples</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">isinstance</span>(next_word, <span class="bu">tuple</span>):</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>            next_word <span class="op">=</span> next_word[<span class="dv">0</span>]</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>        words.append(next_word)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> <span class="st">' '</span>.join(words)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.replace(<span class="st">' &lt;s&gt; &lt;s&gt;'</span>, <span class="st">'.'</span>) <span class="op">+</span> <span class="st">'.'</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> text.upper() <span class="co"># To give that telegraph message look :-)</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>generate_text(<span class="st">'the'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>THE MORE I SAW YOU WEAR A RING BEFORE EDWARD. APPARENTLY VERY LITTLE BESIDES SENDING AWAY SOME OF THESE SUPERIOR BLESSINGS COULD BE MORE LOST TO ME AND IN ENDEAVOURING TO APPEAR IN THEIR PARSONAGE BY MICHAELMAS AND SHE HAS MADE EVERYTHING BELONGING TO A BELIEF OF BEING SEEN WITH HIM. HER NERVES SUFFICIENTLY TO FEEL IT A MORE WILLING MIND IN HER NATURAL TONE OF CORDIALITY I BEG YOUR PARDON MR. TWO THOUSAND POUNDS WHICH HAD DESERTED AND MELANCHOLY LOOKING ROOMS AND A HALF IS A GOOD WALKER OH YES. A MIXTURE OF THOSE MOST CONCERNED. ELINOR HAD MET. SEEMED NO OTHERWISE INTELLIGIBLE. SISTER OR WHAT DIABOLICAL MOTIVE YOU MAY AS WELL SATISFIED WITH HER LAUGHED WITH HER STATE OF SPIRITS. BE DONE IN RAPID MOMENTS CAPTAIN BENWICK WHICH HE COMMUNICATED TO HIS PRESENT CURACY AND OBTAINING THAT OF MY FAMILY. KNOW HOW TO HOLD THE BLESSINGS OF HEALTH AND LOOKS OR LADY MIDDLETON WAS NOT LIKELY TO BE DONE. AN ACCOUNT OF HER HEART PROPHESIED SOME MISCHANCE TO DAMP THE PERFECTION OF HER MOTHER. LIBERTY WITH YOU. AND THOSE WHO HAVE NOT BEEN VERY AGREEABLE TO THEIR FORMER GOOD UNDERSTANDING WAS COMPLETELY A GENTLEMAN OF CONSEQUENCE. BY. PRODUCED A VERY PLEASANT ADDITION TO THESE. OF THE MIDDLETONS AND PALMERS HOW AM I BE OF THE HOUSE FOR THEIR MEETING.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>generate_text(<span class="st">'she'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SHE I MIGHT SEE IT TO EDWARD SHE BELIEVED HER CAPABLE OF THE GENTLEMAN. THE NUMBER OF HER SICK CHILD IS ALWAYS SUPPOSING THAT PERHAPS. SHE ADDED IN A MANNER FORCED ON ME BY THE BYE HAD A VERY DIFFERENT EFFECT SAW NOTHING TO BE HOWEVER DISAGREEABLE YET TOO RAPID. HILL WHICH PARTED UPPERCROSS AND IN THE FAMILY AT THE FORM OF IT FOR IT HAS CARRIED AWAY FROM HIS DAUGHTER S WISHES COULD BE CANVASSED ONLY IN GENERAL SO EARNESTLY GRATEFUL SO FULL OF AFFECTION AND INFLUENCE. DEAR COUSIN YOU ARE CERTAIN OF MEETING THEM AND NOBODY BUT LUCY S BEAU IS QUITE UNDERSTOOD I GIVE THEM ALL WITH THE SIZE AND MENTAL ALACRITY DID NOT MAKE MORE THAN A THICK SCREEN OF THEM ALL INTO THE SICK ROOM THAN MARIANNE RINGING THE BELL. FULL OF MEANING TO BE CONTRADICTED. DESIRE YOU WILL SOON BE BACK AGAIN DIRECTLY. WILL BE THE MEANING OF IT. AS THIS CANNOT BE FORCED INTO PRUDENCE IN HER NOTIONS OF A DIFFERENT CAUSE NO LESS CONTENTED WITH THE HARVILLES WHILE THE EYES OF SENSIBLE PEOPLE BY ACTING LIKE A MAN WHO FOR MORE THAN EQUAL ANY OF THEM ALL THAT REMAINS. TELL ME OF IT AT ALL WONDER AT HERSELF FOR BEING SO GENUINELY AND UNAFFECTEDLY ILL NATURED OR ILL BRED AS HE WAS SILENT. SWEET THINGS THAT THEY ONLY HAVE A LITTLE COLD ALREADY.</code></pre>
</div>
</div>
</section>
<section id="save" class="level2">
<h2 class="anchored" data-anchor-id="save">Save</h2>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>path_prefix <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>output_dir<span class="sc">}</span><span class="ss">/austen-combo"</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>vocab.to_csv(<span class="ss">f"</span><span class="sc">{</span>path_prefix<span class="sc">}</span><span class="ss">-VOCAB-v1.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>tokens.to_csv(<span class="ss">f"</span><span class="sc">{</span>path_prefix<span class="sc">}</span><span class="ss">-TOKENS-v1.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>m1.to_csv(<span class="ss">f"</span><span class="sc">{</span>path_prefix<span class="sc">}</span><span class="ss">-M1-v1.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>m2.to_csv(<span class="ss">f"</span><span class="sc">{</span>path_prefix<span class="sc">}</span><span class="ss">-M2-v1.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>m3.to_csv(<span class="ss">f"</span><span class="sc">{</span>path_prefix<span class="sc">}</span><span class="ss">-M3-v1.csv"</span>, index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../lessons/M03_LanguageModels/M03_01a_EntropyExamples.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Entropy Examples</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../lessons/M03_LanguageModels/M03_02_LanguageModels_V2.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-title">Inferring Language Models (v2)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>